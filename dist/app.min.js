"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function a11yActivate(e,t){var n=[" "];"BUTTON"===e.tagName&&(n=[" "]),e.addEventListener("click",t),e.addEventListener("keyup",function(e){-1<n.indexOf(e.key)&&t(e)})}function addNavListener(){var e=document.getElementById("nav-menu"),t=document.querySelector("header"),n=document.querySelectorAll("#top-nav li");e.addEventListener("click",function(){t.classList.toggle("open")}),n.forEach(function(t){t.addEventListener("click",function(e){document.querySelector("#top-nav li.current").classList.remove("current"),t.classList.add("current")})})}function addCardListeners(){var e=document.querySelectorAll(".card"),t=document.querySelectorAll(".skip-card");_toConsumableArray(e).forEach(function(t){t.setAttribute("tabindex","0"),addCardKeyboardControls(t,e),t.addEventListener("click",function(e){setActive(t)})}),_toConsumableArray(t).forEach(function(e){a11yActivate(e,skipCard)})}function closeTranscripts(){document.querySelectorAll(".transcript").forEach(function(e){e.classList.add("closed")}),document.querySelectorAll(".transcript-toggle").forEach(function(e){e.setAttribute("aria-expanded","false")})}function playCardVideo(e){playYoutube(e)}function playYoutube(e){youTubePlayers?$(e).find(".youtube")[0].contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*"):console.error("no players loaded")}function addCardKeyboardControls(n,i){n.addEventListener("keyup",function(e){switch(e.key){case"Enter":if(e.target.classList.contains("transcript-toggle"))break;case" ":e.preventDefault(),setActive(n);break;case"Escape":setActive();break;case"Home":e.preventDefault(),setActive(i[0]);break;case"End":e.preventDefault(),setActive(i[i.length-1]);break;case"ArrowRight":i[i.length-1]!==n&&((t=n.nextElementSibling).focus(),setActive(t));break;case"ArrowLeft":var t;i[0]!==n&&((t=n.previousElementSibling).focus(),setActive(t))}})}function skipCard(e){e.preventDefault(),e.stopPropagation();e=e.target.hash.substring(1),e=document.getElementById(e);e.focus(),setActive(e)}function setActive(t){closeTranscripts(),pauseVideos();var e=document.getElementById("close-cards-button");_toConsumableArray(document.querySelectorAll(".active")).forEach(function(e){e.classList.remove("active"),e.setAttribute("aria-expanded","false")}),t?(_toConsumableArray(document.querySelectorAll(".no-active")).forEach(function(e){e.classList.remove("no-active"),e.classList.add("has-active")}),t.classList.add("active"),t.addEventListener("transitionend",function(e){e.target.parentNode.classList.contains("active")&&"transform"===e.propertyName&&playCardVideo(t)}),t.setAttribute("aria-expanded","true"),e&&(e.tabIndex=0)):(_toConsumableArray(document.querySelectorAll(".has-active")).forEach(function(e){e.classList.remove("has-active"),e.classList.add("no-active")}),e&&(e.tabIndex=-1))}$(function(){document.querySelector("html").classList.remove("no-js"),addNavListener(),addCardListeners(),addTranscripts(),loadTobii(),initYoutube(),initSlick()}),window.addEventListener("keydown",function(e){this.document.activeElement.classList.contains("card")&&" "==e.key&&e.preventDefault()});var youTubePlayers=[];function initYoutube(){for(var e=document.querySelectorAll(".youtube"),t=0;t<e.length;t++)youTubePlayers.push(e[t])}function pauseVideos(){youTubePlayers.forEach(function(e){e.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")})}function addTranscripts(){for(var e=document.querySelectorAll(".transcript-toggle"),t=0;t<e.length;t++)a11yActivate(e[t],toggleTranscript)}function toggleTranscript(e){e.stopPropagation(),e.preventDefault();var t="true"==(t=e.target.getAttribute("aria-expanded"))?"false":"true";e.target.setAttribute("aria-expanded",t),e.target.parentElement.querySelector(".transcript").classList.toggle("closed")}function getCaption(e){return e.querySelector("figcaption").innerText}function loadTobii(){document.querySelector("div.tobii")&&Tobii.destroy();new Tobii({captionsSelector:"self",captionAttribute:"data-caption",captionText:getCaption})}function initSlick(){$(".comic-wrapper").length?setupSlick():console.log("no slick",$("#comic-wrapper"))}function setupSlick(){$(".panels").on("init",setSlickConfig),$(".panels").slick({dots:!0,slidesToShow:3,slidesToScroll:1,centerMode:!0,variableWidth:!0,infinite:!1,initialSlide:0})}function setSlickConfig(e){console.log("set config"),$("div[data-slick-index]").click(function(e){e.preventDefault(),goToSlide($(this).data("slickIndex"))}),$("div[data-slick-index]").focusin(function(e){e.preventDefault(),goToSlide($(this).data("slickIndex"))})}function goToSlide(e){$(".panels").slick("slickGoTo",e)}function checkMediaQuery(){var e,t=document.getElementById("bg-vid");t&&(null!==(e=document.querySelector("#bg-vid > source"))?console.log("there is source",e):(addSource(t),t.load()))}function addSource(e){var t;e&&((t=document.createElement("source")).type="video/mp4",document.createElement("video"),1020<window.innerWidth?t.src="/videos/home/intro-loop_1080.mp4":700<window.innerWidth?t.src="/videos/home/intro-loop_720.mp4":425<window.innerWidth&&(t.src="/videos/home/intro-loop_540.mp4"),e.appendChild(t))}function has_id(e){try{document.getElementById(e).value}catch(e){return!1}return!0}function has_name(e){try{cfrm.nm.type}catch(e){return!1}return!0}function $$(e){return has_id(e)||has_name(e)?has_id(e)?document.getElementById(e).value:void 0:(alert("Field "+e+" does not exist!\n Form validation configuration error."),!1)}function $val(e){return document.getElementById(e)}function trim(e){$val(e).value=$val(e).value.replace(/^\s+/,"").replace(/\s+$/,"")}!function(){var c=null,s=0,l=null,u=0,d=window,f=document,p=f.documentElement,y=f.body;function m(){s&&(clearTimeout(s),s=0,c.classList.remove("flying-focus_visible"),l.classList.remove("flying-focus_target"),l=null)}p.addEventListener("keydown",function(e){e=e.which;(9===e||36<e&&e<41)&&(u=Date.now())},!1),p.addEventListener("focus",function(e){var t,n,i,o,r,a,e=e.target;"flying-focus"!==e.id&&(t=!1,c||(t=!0,(c=f.createElement("flying-focus")).id="flying-focus",c.style.transitionDuration=c.style.WebkitTransitionDuration="0.15s",y.appendChild(c)),n=(n=e).getBoundingClientRect(),i=p.clientLeft||y.clientLeft,o=p.clientTop||y.clientTop,r=d.pageXOffset||p.scrollLeft||y.scrollLeft,a=d.pageYOffset||p.scrollTop||y.scrollTop,r=n.left+r-i,i={top:n.top+a-o||0,left:r||0},c.style.left=i.left+"px",c.style.top=i.top+"px",c.style.width=e.offsetWidth+"px",c.style.height=e.offsetHeight+"px",!t&&Date.now()-u<42&&(m(),e.classList.add("flying-focus_target"),c.classList.add("flying-focus_visible"),l=e,s=setTimeout(m,150)))},!0),p.addEventListener("blur",function(){m()},!0);var e=f.createElement("style");e.textContent="#flying-focus {\tposition: absolute;\tmargin: 0;\tbackground: transparent;\t-webkit-transition-property: left, top, width, height;\ttransition-property: left, top, width, height;\t-webkit-transition-timing-function: cubic-bezier(0,1,0,1);\ttransition-timing-function: cubic-bezier(0,1,0,1);\tvisibility: hidden;\tpointer-events: none;\tbox-shadow: 0 0 2px 3px #78aeda, 0 0 2px #78aeda inset; border-radius: 2px;}#flying-focus.flying-focus_visible {\tvisibility: visible;\tz-index: 9999;}.flying-focus_target {\toutline: none !important; /* Doesn't work in Firefox :( */}/* http://stackoverflow.com/questions/71074/how-to-remove-firefoxs-dotted-outline-on-buttons-as-well-as-links/199319 */.flying-focus_target::-moz-focus-inner {\tborder: 0 !important;}/* Replace it with @supports rule when browsers catch up */@media screen and (-webkit-min-device-pixel-ratio: 0) {\t#flying-focus {\t\tbox-shadow: none;\t\toutline: 5px auto -webkit-focus-ring-color;\t\toutline-offset: -3px;\t}}",y.appendChild(e)}(),checkMediaQuery();var required={field:[],add:function(e,t,n){this.field[this.field.length]=[e,t,n]},out:function(){return this.field},clear:function(){this.field=[]}},validate={check:function(e){for(var t="Please fix the following errors:\n\n",n="",i=!0,o=0;o<required.field.length;o++)this.checkit(required.field[o][0],required.field[o][1],e)||(t=t+required.field[o][2]+" must be supplied\n",has_id(required.field[o][0])&&0===n.length&&(n=required.field[o][0]),i=!1);return i||alert(t),0<n.length&&document.getElementById(n).focus(),i},checkit:function(e,t,n){return"NOT_EMPTY"==t?!(this.trim($$(e)).length<1):"EMAIL"==t?(exp=/^[a-zA-Z0-9._%-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,null!=$$(e).match(exp)):void 0},trim:function(e){return 0<e.length?e.replace(/^\s+/,"").replace(/\s+$/,""):e}};